;================================================================================================
; MAIN CONFIGURATION FILE OF WINDOWSORCHESTRATOR
;================================================================================================
;
; WARNING: This file controls the critical behavior of the system and applications.
; Modify these settings with caution. An incorrect configuration can lead to
; unexpected system behavior (e.g., failure to launch the main application).
;
; SYNTAX:
;   - Lines beginning with a semicolon (;) are comments and are ignored.
;   - Boolean values must be 'true' or 'false'.
;   - To disable a feature (e.g., scheduled reboot), leave its value empty.
;
;================================================================================================

[SystemConfig]
;------------------------------------------------------------------------------------------------
; Manages operating system-level settings: startup, updates, session.
;------------------------------------------------------------------------------------------------

;--- USER SESSION MANAGEMENT ---

; Username for the session.
; If SessionStartupMode is Standard or Autologon, this is the user who will connect.
; If empty, the script will use the user who runs the installation.
AutoLoginUsername=

; Defines how the user session and the main application start.
;   Standard: Default Windows behavior (manual logon screen). The app starts after logon.
;   Autologon: Logs on the user automatically and shows the desktop. The app starts after logon.
SessionStartupMode=Autologon

;--- POWER AND STARTUP MANAGEMENT ---

; Disable Windows Fast Startup.
;   true : (Recommended) Disables "fast startup" to ensure a full and more stable reboot.
;   false : Lets Windows manage this setting.
DisableFastStartup=true

; Disable computer sleep.
;   true : Prevents the system from entering sleep or hibernate mode (S3/S4). Useful for systems that must remain active.
;   false : Allows sleep according to Windows settings.
DisableSleep=true

; Disable screen sleep.
;   true : Prevents the screen from turning off after a period of inactivity.
;   false : Allows the screen to sleep.
DisableScreenSleep=false

;--- UPDATES AND REBOOTS MANAGEMENT ---

; Complete disabling of the Windows Update service.
;   true : The Windows Update service is disabled, preventing automatic updates.
;   false : The Windows Update service is allowed to run normally.
DisableWindowsUpdate=false

; Prevents Windows from automatically rebooting after an update.
;   true : Prevents forced reboot if a user is logged on.
;   false : Allows Windows to reboot automatically.
DisableAutoReboot=true

;--- SYSTEM APPLICATIONS AND SERVICES ---

; Defines how to manage OneDrive.
;   Ignore: The orchestrator takes no action.
;   Close: The orchestrator closes the OneDrive.exe process if it's running.
;   Block: The orchestrator uses a system policy to prevent OneDrive from running.
OneDriveManagementMode=Close


[Process]
;------------------------------------------------------------------------------------------------
; Manages the launch and monitoring of the main business application.
;------------------------------------------------------------------------------------------------

;--- SCHEDULED ACTION BEFORE DAILY REBOOT ---
; Time (HH:MM) to execute a preparatory command before the scheduled reboot.
; Must be earlier than 'ScheduledRebootTime'. Leave empty to not execute any action.
ScheduledCloseTime=02:50

; Command or path to the script/executable to run before the reboot.
; Example: C:\Scripts\backup.bat
; Example: PreReboot.bat (if the script is in the same folder as config_systeme.ps1)
ScheduledCloseCommand="management\Invoke-DatabaseBackup.ps1"

; Arguments for the shutdown command.
; Leave empty if no arguments are needed.
; Example: -Mode Backup -Verbose
ScheduledCloseArguments=

;--- SCHEDULED ACTION DAILY REBOOT
; Time (HH:MM) of the daily reboot scheduled by the script.
; To disable the daily reboot, leave this value empty.
ScheduledRebootTime=02:59

; Command to execute to start the application (path to .bat, .exe, etc.).
ProcessToLaunch="LaunchApp.bat"

; Arguments for the (re)opening of the main application.
ProcessArguments=

; Name of the final process to monitor to check if the application is running.
; This is the name of the process WITHOUT the .exe extension (e.g., "MyApp").
; Leave this field EMPTY if you are using a wrapper script and do not want to monitor.
ProcessToMonitor=MyApp

; Defines the console environment for launching external scripts (.bat, .cmd).
;   Standard: (Default) Lets the OS decide the terminal (usually Windows Terminal).
;   Legacy: Forces the launch in a new, separate legacy console window (cmd.exe).
LaunchConsoleMode=Standard

; If true, the main application will be launched minimized in the taskbar.
StartProcessMinimized=false


[DatabaseBackup]
;------------------------------------------------------------------------------------------------
; Manages the automatic backup of database files before the daily reboot.
;------------------------------------------------------------------------------------------------

; Set to true to enable the backup of recently modified files.
EnableBackup=false

; Time (HH:MM) to execute the backup.
; Recommendation: Set this 5-10 minutes AFTER ScheduledCloseTime.
ScheduledBackupTime=02:56

; Source folder containing the database files to monitor.
; Relative paths like '..\..\AllUser' are resolved from the script's location.
DatabaseSourcePath=..\data

; Destination folder where the backups will be stored.
DatabaseDestinationPath=..\data\BackupDaily

; Defines how many days backups are kept. Older archives are automatically deleted.
DatabaseKeepDays=30


[Installation]
;------------------------------------------------------------------------------------------------
; Manages installation and uninstallation behavior.
;------------------------------------------------------------------------------------------------

; Skip the EULA consent prompt for the Autologon tool.
;   true : Skips the EULA display and consent dialog, assuming acceptance for automated deployments.
;          WARNING: Setting this to true implies legal acceptance of the Microsoft Sysinternals Autologon EULA.
;          Use only in environments where EULA acceptance is pre-approved.
;   false: Displays the EULA and requires user consent (default, secure behavior).
SkipEulaPrompt=false

; Automatically reboot the system upon completion of installation or uninstallation.
;   true : A reboot is initiated to ensure all system changes are correctly applied.
;   false: The automatic reboot is suppressed (useful for development and testing).
RebootOnCompletion=false

; Grace period in seconds before the reboot is forced.
; This value is only used if RebootOnCompletion is set to true.
RebootGracePeriod=15

; Manages the exit behavior of the PowerShell window when RebootOnCompletion is false.
;   manual: The window waits for the user to press Enter (default).
;   automatic: The window closes automatically after the specified delay.
PowerShellExitMode=automatic

; Delay in seconds before the PowerShell window closes in 'automatic' mode.
PowerShellExitDelay=15

; Use the assistant to configure the Microsoft Autologon tool.
; This is only effective if SessionStartupMode is set to 'Autologon'.
UseAutologonAssistant=true

; Controls the visibility of optional, context-specific information messages in the Graphical User Interface (GUI).
; These messages provide operational context (e.g., the optimization note for Allv023-05).
;   true: (Default) Displays all contextual guidance messages in the configuration wizard.
;   false: Hides all optional context messages for a cleaner, generic production GUI.
ShowContextMessages=true

; Hides the PowerShell console window during installation/uninstallation.
;   true : The console window is hidden. Ideal for end-user deployments.
;          All output is still logged to files in the Logs/ folder.
;          A MessageBox notification will appear at the end to inform of success/failure.
;   false: (Default) The console window remains visible. Useful for development and debugging.
; NOTE: The graphical interface (firstconfig.ps1) remains always visible regardless of this setting.
SilentMode=true

; URL for downloading the Autologon tool.
; Only change this if the official link from Microsoft is broken or updated.
AutologonDownloadUrl=https://live.sysinternals.com/files/AutoLogon.zip


[Logging]
;------------------------------------------------------------------------------------------------
; Manages the behavior of log files (logs).
;------------------------------------------------------------------------------------------------

; Enables or disables log rotation to prevent them from becoming too large.
;   true : Old logs are archived (log.txt -> log.1.txt) at each launch.
;   false : A single log file is used and grows indefinitely.
EnableLogRotation=true

; Maximum number of log files to keep for the system script.
; Includes the current log and archives. '7' means keeping the logs for the last 7 days.
MaxSystemLogsToKeep=7

; Maximum number of log files to keep for the user script.
MaxUserLogsToKeep=7


[Gotify]
;------------------------------------------------------------------------------------------------
; Manages sending status notifications via a Gotify server. (Optional)
;------------------------------------------------------------------------------------------------

; Enables or disables Gotify notifications.
EnableGotify=false

; Base URL of your Gotify instance.
Url=

; Token of the application created in Gotify for sending messages.
Token=

; Priority of Gotify messages (an integer).
Priority=1

; Notification titles. You can use the %COMPUTERNAME% and %USERNAME% variables.
GotifyTitleSuccessSystem=%COMPUTERNAME% System
GotifyTitleErrorSystem=ERROR System Configuration on %COMPUTERNAME%
GotifyTitleSuccessUser=%COMPUTERNAME% %USERNAME%
GotifyTitleErrorUser=ERROR User Configuration %USERNAME% on %COMPUTERNAME%

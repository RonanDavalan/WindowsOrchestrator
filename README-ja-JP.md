# WindowsAutoConfig ⚙️

[🇺🇸 English](README.md) | [🇫🇷 Français](README-fr-FR.md) | [🇩🇪 Deutsch](README-de-DE.md) | [🇪🇸 Español](README-es-ES.md) | [🇮🇳 हिंदी](README-hi-IN.md) | [🇷🇺 Русский](README-ru-RU.md) | [🇨🇳 中文](README-zh-CN.md) | [🇸🇦 العربية](README-ar-SA.md) | [🇧🇩 বাংলা](README-bn-BD.md) | [🇮🇩 Bahasa Indonesia](README-id-ID.md)

**専用Windowsワークステーションのための自動操縦システム。一度設定すれば、システムは信頼性高く自己管理します。**

![ライセンス](https://img.shields.io/badge/Licence-GPLv3-blue.svg)![PowerShellバージョン](https://img.shields.io/badge/PowerShell-5.1%2B-blue)![ステータス](https://img.shields.io/badge/Statut-Opérationnel-brightgreen.svg)![OS](https://img.shields.io/badge/OS-Windows_10_|_11-informational)![サポート](https://img.shields.io/badge/Support-11_Langues-orange.svg)![貢献](https://img.shields.io/badge/Contributions-Bienvenues-brightgreen.svg)

---

## 🎯 私たちの使命

完全に信頼性が高く、自律的なWindowsワークステーションを想像してみてください。接続されたデバイスの制御、デジタルディスプレイの表示、監視ステーションとしての役割など、その使命のために一度設定すれば、あとは忘れてしまえるマシンです。アプリケーションが中断することなく**永続的に運用可能**であることを保証するシステムです。

これが**WindowsAutoConfig**が達成を支援する目標です。課題は、標準のWindows PCが元々このような耐久性のために設計されていないことです。それは人間の対話のために作られています。電力を節約するためにスリープ状態になり、適切と判断したときに更新をインストールし、再起動後にアプリケーションを自動的に再起動しません。

**WindowsAutoConfig**は解決策です。インテリジェントで永続的なスーパーバイザーとして機能するスクリプトのセットです。あらゆるPCを信頼性の高いオートマトンに変え、手動介入なしで重要なアプリケーションが常に動作していることを保証します。

### インターフェースを超えて：直接的なシステム制御

WindowsAutoConfigは、標準のWindows UIでは利用できない、または管理が難しい強力な構成をアクセス可能にする高度なコントロールパネルとして機能します。

*   **Windows Updateの完全な制御：** 更新を単に「一時停止」するのではなく、スクリプトはシステムポリシーを変更して自動メカニズムを停止させ、更新をいつインストールするかについての制御を取り戻します。
*   **信頼性の高い電源設定：** スクリプトはスリープを「なし」に設定するだけではありません。この設定がすべての起動時に再適用されることを保証し、構成を不要な変更に対して回復力のあるものにします。
*   **管理者レベルの設定へのアクセス：** システムポリシーを介したOneDriveの無効化などの機能は、通常、グループポリシーエディター（Windows Homeでは利用不可）に隠されています。このスクリプトは、これらを誰でも利用できるようにします。

## ✨ 主な機能
*   **グラフィカル設定ウィザード：** 基本設定のためにファイルを編集する必要はありません。
*   **完全な多言語サポート：** システム言語の自動検出機能を備えた、11言語で利用可能なインターフェースとログ。
*   **電源管理：** マシンのスリープ、ディスプレイのスリープ、Windows高速スタートアップを無効にして、最大限の安定性を確保します。
*   **自動ログイン (Auto-Login)：** 安全なパスワード管理のために **Sysinternals AutoLogon** ツールと連携して自動ログインを管理します。
*   **Windows Update制御：** 強制的なアップデートや再起動がアプリケーションの動作を妨げるのを防ぎます。
*   **プロセス管理：** セッションごとにメインアプリケーションを自動的に起動、監視、再起動します。
*   **毎日計画再起動：** システムの新鮮さを保つために毎日再起動をスケジュールします。
*   **再起動前アクション：** 計画再起動の前にカスタムスクリプト（バックアップ、クリーンアップなど）を実行します。
*   **詳細なログ記録：** すべてのアクションは診断を容易にするためにログファイルに記録されます。
*   **通知（オプション）：** Gotify経由でステータスレポートを送信します。

---

## 🎯 対象者とベストプラクティス

このプロジェクトは、PCを信頼性の高い自動化システムに変えるために設計されており、マシンが単一のアプリケーション（IoTデバイス用サーバー、デジタルサイネージ、監視ステーションなど）専用である場合に最適です。汎用のオフィスコンピュータや日常的な使用にはお勧めできません。

*   **メジャーWindowsアップデート：** 重大なアップデート（例：Windows 10から11へのアップグレード）の場合、最も安全な手順は、アップデート前にWindowsAutoConfigを**アンインストール**し、その後**再インストール**することです。
*   **企業環境：** コンピュータがグループポリシーオブジェクト（GPO）によって管理されている企業ドメインの一部である場合は、このスクリプトによる変更が組織のポリシーと競合しないことをIT部門に確認してください。

---

## 🚀 インストールと利用開始

**言語に関する注意：** 起動スクリプト（`1_install.bat`および`2_uninstall.bat`）は、指示を**英語**で表示します。これは正常です。これらのファイルは単純なランチャーとして機能します。グラフィカルウィザードまたはPowerShellスクリプトが引き継ぐとすぐに、インターフェイスはオペレーティングシステムの言語に自動的に適応します。

**WindowsAutoConfig** のセットアップは、シンプルでガイド付きのプロセスです。

1.  構成するコンピューターにプロジェクトを**ダウンロード**またはクローンします。
2.  `1_install.bat` を実行します。スクリプトは2つのステップで案内します。
    *   **ステップ1：グラフィカルウィザードによる設定。**
        必要に応じてオプションを調整します。最も重要なのは、通常、自動ログイン用のユーザーIDと起動するアプリケーションです。`保存`をクリックして保存します。
    *   **ステップ2：システムタスクのインストール。**
        スクリプトは続行の確認を求めます。Windowsセキュリティ（UAC）ウィンドウが開きます。必要なスケジュールされたタスクを作成するために、**これを受け入れる必要があります**。
3.  完了です！次回の再起動時に、設定が適用されます。

---

## 🔧 設定
設定はいつでも2つの方法で調整できます。

### 1. グラフィカルウィザード（簡単な方法）
`1_install.bat` を再実行して、設定インターフェースを再度開きます。設定を変更して保存します。

### 2. `config.ini` ファイル（高度な方法）
テキストエディタで `config.ini` を開き、詳細に制御します。

#### 自動ログインとパスワードに関する重要な注意
セキュリティ上の理由から、**WindowsAutoConfig はパスワードを平文で管理または保存することはありません。** ここでは、効果的かつ安全に自動ログインを構成する方法を説明します。

*   **シナリオ1：ユーザーアカウントにパスワードがない場合。**
    グラフィカルウィザードまたは `config.ini` ファイルの `AutoLoginUsername` にユーザー名を入力するだけです。

*   **シナリオ2：ユーザーアカウントにパスワードがある場合（推奨方法）。**
    1.  Microsoftの公式ツール **[Sysinternals AutoLogon](https://download.sysinternals.com/files/AutoLogon.zip)** をダウンロードします（直接ダウンロードリンク）。
    2.  AutoLogon を起動し、ユーザー名、ドメイン、パスワードを入力します。このツールはパスワードをレジストリに安全に保存します。
    3.  **WindowsAutoConfig** の設定では、`AutoLoginUsername` フィールドを空白のままにするか（スクリプトは対応するレジストリキーを読み取ってAutoLogonによって設定されたユーザーを検出します）、または確実にするために記入することもできます。当社のスクリプトは、`AutoAdminLogon` レジストリキーが正しく有効になっていることを確認して、設定を完了します。

#### 高度な設定：`PreRebootActionCommand`
この強力な機能を使用すると、毎日の再起動前にスクリプトを実行できます。パスは次のいずれかになります。
- **絶対パス：** `C:\Scripts\my_backup.bat`
- **プロジェクト相対パス：** `PreReboot.bat`（スクリプトはこのファイルをプロジェクトのルートで探します）。
- **`%USERPROFILE%` を使用：** `%USERPROFILE%\Desktop\cleanup.ps1`（スクリプトは `%USERPROFILE%` を自動ログインユーザーのプロファイルパスにインテリジェントに置き換えます）。

---

## 📂 プロジェクト構造
```
WindowsAutoConfig/
├── 1_install.bat                # インストールと設定のエントリポイント
├── 2_uninstall.bat              # アンインストールのエントリポイント
├── config.ini                   # 中央設定ファイル
├── config_systeme.ps1           # マシン設定用のメインスクリプト（起動時に実行）
├── config_utilisateur.ps1       # ユーザープロセス管理用のメインスクリプト（ログイン時に実行）
├── LaunchApp.bat                # (サンプル) メインアプリケーション用のポータブルランチャー
├── PreReboot.bat                # 再起動前アクションのスクリプト例
├── Logs/                        # （自動作成）ログファイルが含まれています
├── i18n/                        # すべての翻訳ファイルが含まれています
│   ├── ja-JP/strings.psd1
│   └── ... (他の言語)
└── management/
    ├── defaults/default_config.ini # 初期設定テンプレート
    ├── tools/                   # 診断ツール
    │   └── Find-WindowInfo.ps1
    ├── firstconfig.ps1          # グラフィカル設定ウィザードのコード
    ├── install.ps1              # タスクインストール用の技術スクリプト
    └── uninstall.ps1            # タスク削除用の技術スクリプト
```

---

## ⚙️ 詳細な動作
**WindowsAutoConfig** の核心は、Windowsタスクスケジューラに依存しています。

1.  **Windows起動時**
    *   `WindowsAutoConfig_SystemStartup` タスクは `SYSTEM` 権限で実行されます。
    *   `config_systeme.ps1` スクリプトは `config.ini` を読み取り、すべてのマシン設定を適用します。また、再起動タスクの作成/更新も管理します。

2.  **ユーザーログイン時**
    *   `WindowsAutoConfig_UserLogon` タスクが実行されます。
    *   `config_utilisateur.ps1` スクリプトは `config.ini` の `[Process]` セクションを読み取り、メインアプリケーションが正しく起動していることを確認します。すでに実行中の場合は、一度停止してからクリーンに再起動されます。

3.  **毎日（設定されている場合）**
    *   `WindowsAutoConfig_PreRebootAction` タスクは、バックアップ/クリーンアップスクリプトを実行します。
    *   数分後、`WindowsAutoConfig_ScheduledReboot` タスクがコンピューターを再起動します。

---

### 🛠️ 診断および開発ツール

このプロジェクトには、プロジェクトの構成と保守に役立つスクリプトが含まれています。

*   **`management/tools/Find-WindowInfo.ps1`**: アプリケーションのウィンドウの正確なタイトルがわからない場合（たとえば、`Close-AppByTitle.ps1`で構成するため）、このスクリプトを実行します。表示されているすべてのウィンドウとそのプロセス名がリストされ、正確な情報を見つけるのに役立ちます。
*   **`Fix-Encoding.ps1`**: スクリプトを変更した場合、このツールは、PowerShell 5.1および国際文字との完全な互換性のために、正しいエンコーディング（BOM付きUTF-8）で保存されることを保証します。

---

## 📄 ログ記録 (Logging)
簡単なトラブルシューティングのために、すべてがログに記録されます。
*   **場所：** `Logs/` サブフォルダ内。
*   **ファイル：** `config_systeme_ps_log.txt` と `config_utilisateur_log.txt`。
*   **ローテーション：** 古いログは、サイズが大きくなりすぎないように自動的にアーカイブされます。

---

## 🗑️ アンインストール
システムを削除するには：
1.  `2_uninstall.bat` を実行します。
2.  **権限昇格の要求 (UAC) を受け入れます**。
3.  スクリプトは、スケジュールされたすべてのタスクをクリーンに削除し、主要なシステム設定を復元します。

**可逆性に関する注意：** アンインストールは、スケジュールされたタスクを削除するだけではありません。また、主要なシステム設定をデフォルトの状態に復元して、クリーンなシステムを提供します。
*   Windowsアップデートが再度有効になります。
*   高速スタートアップが再度有効になります。
*   OneDriveをブロックするポリシーが削除されます。
*   スクリプトは、自動ログインを無効にすることを提案します。

したがって、システムは残りの変更なしで標準のワークステーションに戻ります。

---

## ❤️ ライセンスと貢献
このプロジェクトは **GPLv3** ライセンスの下で配布されています。全文は `LICENSE` ファイルで確認できます。

バグ報告、改善提案、プルリクエストなど、あらゆる形の貢献を歓迎します。